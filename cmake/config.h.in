/*
 * config.h.in - Configuration header template for KVMDB
 * 
 * This file is processed by CMake to generate include/kvm_db/config.h
 * with the actual configuration values.
 */

#ifndef KVM_DB_CONFIG_H
#define KVM_DB_CONFIG_H

/* Project information */
#define KVM_DB_VERSION_MAJOR @KVMDB_VERSION_MAJOR@
#define KVM_DB_VERSION_MINOR @KVMDB_VERSION_MINOR@
#define KVM_DB_VERSION_PATCH @KVMDB_VERSION_PATCH@
#define KVM_DB_VERSION "@KVMDB_VERSION@"

/* Platform detection */
#cmakedefine01 HAVE_LINUX_KVM_H
#cmakedefine01 HAVE_SYS_IOCTL_H
#cmakedefine01 HAVE_FCNTL_H
#cmakedefine01 HAVE_UNISTD_H
#cmakedefine01 HAVE_KVM_IOCTLS

/* Driver integration */
#cmakedefine01 HAVE_WAL_DRIVER
#ifdef HAVE_WAL_DRIVER
    #define WAL_DRIVER_BUILD_DIR "@WAL_DRIVER_BUILD_DIR@"
    #define WAL_CHAR_DEVICE "/dev/rwal"
    #define WAL_BLOCK_DEVICE "/dev/wal"
    #define WAL_PROC_ENTRY "/proc/wal_driver"
#endif

#cmakedefine01 HAVE_URINGBLK_DRIVER
#ifdef HAVE_URINGBLK_DRIVER
    #define URINGBLK_DRIVER_BUILD_DIR "@URINGBLK_DRIVER_BUILD_DIR@"
    #define URINGBLK_DEVICE "/dev/uringblk0"
    #define URINGBLK_SYSFS_PATH "/sys/block/uringblk0/uringblk"
#endif

/* C++23 features */
#cmakedefine01 HAVE_CXX23_MODULES
#cmakedefine01 HAVE_CXX23_RANGES
#cmakedefine01 HAVE_CXX23_COROUTINES
#cmakedefine01 HAVE_CXX23_CONCEPTS

/* Filesystem support */
#cmakedefine01 FILESYSTEM_NO_LINK_NEEDED

/* Build configuration */
#cmakedefine01 BUILD_DRIVER_BY_DEFAULT
#cmakedefine01 BUILD_DRIVER_TESTS

/* System information */
#define CMAKE_SYSTEM_NAME "@CMAKE_SYSTEM_NAME@"
#define CMAKE_BUILD_TYPE "@CMAKE_BUILD_TYPE@"
#define CMAKE_CXX_COMPILER_ID "@CMAKE_CXX_COMPILER_ID@"
#define CMAKE_CXX_COMPILER_VERSION "@CMAKE_CXX_COMPILER_VERSION@"

/* Helpful macros */
#if HAVE_WAL_DRIVER
    #define KVM_DB_HAS_WAL_DRIVER 1
#else
    #define KVM_DB_HAS_WAL_DRIVER 0
#endif

#if HAVE_URINGBLK_DRIVER
    #define KVM_DB_HAS_URINGBLK_DRIVER 1
#else
    #define KVM_DB_HAS_URINGBLK_DRIVER 0
#endif

#if HAVE_LINUX_KVM_H && HAVE_KVM_IOCTLS
    #define KVM_DB_HAS_KVM_SUPPORT 1
#else
    #define KVM_DB_HAS_KVM_SUPPORT 0
#endif

/* Debug helpers */
#ifdef NDEBUG
    #define KVM_DB_DEBUG 0
#else
    #define KVM_DB_DEBUG 1
#endif

/* Compiler-specific features */
#ifdef __GNUC__
    #define KVM_DB_LIKELY(x)   __builtin_expect(!!(x), 1)
    #define KVM_DB_UNLIKELY(x) __builtin_expect(!!(x), 0)
#else
    #define KVM_DB_LIKELY(x)   (x)
    #define KVM_DB_UNLIKELY(x) (x)
#endif

#endif /* KVM_DB_CONFIG_H */

